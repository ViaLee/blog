(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{445:function(t,s,a){t.exports=a.p+"assets/img/tserror.df307612.jpg"},446:function(t,s,a){t.exports=a.p+"assets/img/recoil.ee5d1e8b.jpg"},471:function(t,s,a){"use strict";a.r(s);var n=a(57),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h2",{attrs:{id:"_2023"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2023"}},[t._v("#")]),t._v(" 2023")]),t._v(" "),n("h3",{attrs:{id:"_05-29-根据图片主色调设置-dom-背景色"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_05-29-根据图片主色调设置-dom-背景色"}},[t._v("#")]),t._v(" 05/29 根据图片主色调设置 dom 背景色")]),t._v(" "),n("p",[t._v("UI 说 文字背景色要根据上方图片主色调自动设置"),n("br"),t._v("\n查阅了一圈发现两个办法：")]),t._v(" "),n("ul",[n("li",[t._v("JS\n将图片放入 canvas 面板中，使用 canvas cxt 的 getImageData()获取图片色码值，是个很长的数组\n然后遍历数组，对色码进行统计，拿到最多次数的色码值")]),t._v(" "),n("li",[t._v("CSS\n使用高斯模糊&放大"),n("div",{staticClass:"language-css extra-class"},[n("pre",{pre:!0,attrs:{class:"language-css"}},[n("code",[n("span",{pre:!0,attrs:{class:"token selector"}},[t._v("div")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v("background-image")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token url"}},[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("url")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string url"}},[t._v('"图片"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v("transform")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("scale")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("60"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v("filter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("blur")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("50px"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),t._v("两种都有缺点：\n"),n("ol",[n("li",[t._v("需要处理数据多的情况 JS 遍历的数组多且长，消耗性能，也有优化将图片缩小后拿缩略图统计，但个人还是不喜欢 JS 处理")]),t._v(" "),n("li",[t._v("将 dom 放大 60 倍也可能有些问题，且实际效果没有 JS 统计精准，但目前使用的是该方法")])])])]),t._v(" "),n("h3",{attrs:{id:"_05-17-服务器被挖"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_05-17-服务器被挖"}},[t._v("#")]),t._v(" 05/17 服务器被挖")]),t._v(" "),n("p",[t._v("同事发现他的腾讯云服务器运行超级慢，啥也没干 CPU 占满了，然后使用")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("ps")]),t._v(" -aux       "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#所有用户所有进程")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("ps")]),t._v(" -u root    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#root用户进程")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("top")]),t._v(" -u root   "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#root用户进程")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("kill")]),t._v(" -9 PID   "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#终止进程")]),t._v("\n")])])]),n("p",[t._v("查看进程情况，发现有一个占用了 130%CPU，来自 /tmp/kdevtmpfsi"),n("br"),t._v("\n问 ChatGPT，发现是个恶意的挖矿程序，给出了以下阻止方法：")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("find")]),t._v(" / -iname kdevtmpfsi* -exec "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" -fv "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#删除所有kdevtmpfsi相关程序")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("find")]),t._v(" / -iname kinsing* -exec "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" -fv "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#删除所有kdevtmpfsi相关程序")]),t._v("\n")])])]),n("p",[t._v("根据删除的文件地址发现是在 docker 镜像里，可能是 docker 镜像没有做安全设置。"),n("br"),t._v("\n决定写一个脚本监控如果发现 kdevtmpfsi 程序就执行终止。")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("a")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),t._v("docker "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("ps")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" kdevtmpfsi* "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("awk")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{print $1,$NF}'")]),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#列出所有运行中的容器 | 按名称过滤 | 打印ID 和 名称 并赋给a")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$a")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#输出a")]),t._v("\n")])])]),n("p",[t._v("根据 docker 镜像管理工具显示，是镜像运行过程中执行了一段脚本，且采用的静默模式。")]),t._v(" "),n("h3",{attrs:{id:"_05-17-本地资源模拟测试环境资源"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_05-17-本地资源模拟测试环境资源"}},[t._v("#")]),t._v(" 05/17 本地资源模拟测试环境资源")]),t._v(" "),n("ol",[n("li",[t._v("将本地服务转 https，端口使用 443 默认端口，避免端口不一致导致的跨域问题.")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("local-ssl-proxy --source "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("443")]),t._v(" --target "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("8080")]),t._v("\n")])])]),n("ol",{attrs:{start:"2"}},[n("li",[t._v("还报跨域")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("http-server --cors "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将服务启用为允许所有源")]),t._v("\n")])])]),n("ol",{attrs:{start:"3"}},[n("li",[t._v("还报错 net::ERR_CERT_AUTHORITY_INVALID"),n("br"),t._v("\n原因是：浏览器无法验证代理的 https 的 SSL"),n("br"),t._v("\n直接访问该地址，提示安全，点击继续访问后，不报错了。")]),t._v(" "),n("li",[t._v("访问默认端口，Request failed to proxy: ECONNREFUSED，原因也是 3")])]),t._v(" "),n("h3",{attrs:{id:"_05-15-组件库发布-t-环境构建失败"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_05-15-组件库发布-t-环境构建失败"}},[t._v("#")]),t._v(" 05/15 组件库发布 t 环境构建失败")]),t._v(" "),n("p",[t._v("从 gitlab 构建日志分析得出，是写入日志时没有权限。"),n("RouterLink",{attrs:{to:"/pages/blog.html"}},[t._v("详情")])],1),t._v(" "),n("h3",{attrs:{id:"_05-10-离开页面埋点"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_05-10-离开页面埋点"}},[t._v("#")]),t._v(" 05/10 离开页面埋点")]),t._v(" "),n("p",[t._v("写在 beforeUnload 回调里，取消默认事件离开页面会提示用户是否确认离开")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("window"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"beforeunload"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("event")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Cancel the event as stated by the standard.")]),t._v("\n  event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("preventDefault")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Chrome requires returnValue to be set.")]),t._v("\n  event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("returnValue "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"_04-20-协助-app-解决问题"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_04-20-协助-app-解决问题"}},[t._v("#")]),t._v(" 04/20 协助 App 解决问题")]),t._v(" "),n("h4",{attrs:{id:"内嵌-h5-页面获取-app-的-token-首次未获取到"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#内嵌-h5-页面获取-app-的-token-首次未获取到"}},[t._v("#")]),t._v(" 内嵌 H5 页面获取 app 的 token，首次未获取到")]),t._v(" "),n("p",[t._v("安卓环境，清除缓存后重新登录 App，进入 h5 页面，未获取到 token，第二次进入 h5 页面正常。")]),t._v(" "),n("ul",[n("li",[t._v("h5 页面 PC、H5、App 共用，需要区分当前环境")]),t._v(" "),n("li",[t._v("token 有三种情况、H5 自身登录、PC 跳转 URL 带入、App 登录获取")]),t._v(" "),n("li",[t._v("区分是否首次从 App 进入，决定是否要获取 App token")])]),t._v(" "),n("h4",{attrs:{id:"app-内退出登录需要跳转到-app-登录页"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#app-内退出登录需要跳转到-app-登录页"}},[t._v("#")]),t._v(" app 内退出登录需要跳转到 App 登录页")]),t._v(" "),n("ul",[n("li",[t._v("区分环境")]),t._v(" "),n("li",[t._v("跳转 URL Schema")])]),t._v(" "),n("h3",{attrs:{id:"_04-19-egg-混合-react-页面项目"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_04-19-egg-混合-react-页面项目"}},[t._v("#")]),t._v(" 04/19 egg 混合 react 页面项目")]),t._v(" "),n("p",[t._v("老项目采用 egg、jquery 开发、部分页面采用 react 重构、目前方案是将新页面放在一个 react 项目内打包放在老项目里，路由直接读取打包后的产物，问题：")]),t._v(" "),n("ol",[n("li",[n("p",[t._v("统一导航栏，新老页面都是用 react 中的导航栏"),n("br"),t._v("\n将导航栏单独打包输出，在老页面读取产物")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//webpack 配置")]),t._v("\nwebpackConfig"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("entry "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  header"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./src/header.tsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nplugins"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("htmlWebpackPlugin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"header.html"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    chunks"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"header"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    template"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./public/header.html"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])]),t._v(" "),n("li",[n("p",[t._v("需要区分环境读取对应的 build 包，全局变量_system_env 通过中间件统一传入")]),t._v(" "),n("div",{staticClass:"language-ejs extra-class"},[n("pre",{pre:!0,attrs:{class:"language-ejs"}},[n("code",[n("span",{pre:!0,attrs:{class:"token ejs language-ejs"}},[n("span",{pre:!0,attrs:{class:"token delimiter punctuation"}},[t._v("<%-")]),n("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("include")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'../../public/build-'")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("_system_env"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/header.html'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" ")]),n("span",{pre:!0,attrs:{class:"token delimiter punctuation"}},[t._v("-%>")])]),t._v("\n")])])])]),t._v(" "),n("li",[n("p",[t._v("antd 全局样式污染问题"),n("br"),t._v("\n没有发现好的解决办法、暂时通过覆盖解决")])])]),t._v(" "),n("h3",{attrs:{id:"_04-14-error-ts1110-build-type-expected"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_04-14-error-ts1110-build-type-expected"}},[t._v("#")]),t._v(" 04/14 Error TS1110 Build: Type expected")]),t._v(" "),n("p",[n("img",{attrs:{src:a(445),alt:"tserror"}})]),t._v(" "),n("p",[t._v("ts 版本过低,缺少部分类型定义,升级")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('"typescript": "^3.7.5"\n"typescript": "4.2.4",\n')])])]),n("h3",{attrs:{id:"_02-21-系统升级为-macos-ventura"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_02-21-系统升级为-macos-ventura"}},[t._v("#")]),t._v(" 02/21 系统升级为 macOS Ventura")]),t._v(" "),n("p",[t._v("拉 git 项目报错， no matching host key type found."),n("br"),t._v("\n解决："),n("br"),t._v("\n修改~/.ssh/config （没有的话需要新建）文件，添加如下两行配置：")]),t._v(" "),n("p",[n("code",[t._v("HostkeyAlgorithms +ssh-rsa")]),n("br"),t._v(" "),n("code",[t._v("PubkeyAcceptedAlgorithms +ssh-rsa")])]),t._v(" "),n("h3",{attrs:{id:"_02-02-taro-项目编译-h5-白屏"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_02-02-taro-项目编译-h5-白屏"}},[t._v("#")]),t._v(" 02/02 taro 项目编译 h5 白屏")]),t._v(" "),n("ol",[n("li",[t._v("部分安卓手机 UC 浏览器、苹果 safri 浏览器页面白屏；\n本地启动真机访问无异常"),n("br"),t._v("\n本地编译 h5 后使用真机访问白屏")])]),t._v(" "),n("p",[t._v("解决过程："),n("br"),t._v("\n使用 vconsole，CDN 方式引入，看到白屏页面报错："),n("br"),t._v("\n'Uncaught SyntaxError:'super' keyword unexpected here'"),n("br"),t._v("\n是项目中使用的 Recoil 兼容性问题，查看官网发现不支持 ES5，得另外使用 babel 编译。"),n("br"),t._v("\n将 Recoil 以 CDN 方式引入得以解决。暂未找到其他更好的办法。")]),t._v(" "),n("p",[n("img",{attrs:{src:a(446),alt:"Recoil"}})]),t._v(" "),n("ol",{attrs:{start:"2"}},[n("li",[n("p",[t._v("使用 Taro.redirectTo,reLaunch 跳转，路由变化但页面白屏\n版本升级")])]),t._v(" "),n("li",[n("p",[t._v("编译报错，sass 中不支持/运算"),n("br"),t._v("\n打补丁，单独处理")])])]),t._v(" "),n("h2",{attrs:{id:"_2022"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2022"}},[t._v("#")]),t._v(" 2022")]),t._v(" "),n("h3",{attrs:{id:"eslint-报错-忽略"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#eslint-报错-忽略"}},[t._v("#")]),t._v(" eslint 报错 忽略")]),t._v(" "),n("ol",[n("li",[t._v("/_ eslint-disable _/")]),t._v(" "),n("li",[t._v('在.eslintrc.js>rules 添加@typescript-eslint/no-var-requires ，如下：\nrules: {\n"@typescript-eslint/no-var-requires": 0,\n}')])]),t._v(" "),n("h3",{attrs:{id:"下载文件-文件过大-报错"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#下载文件-文件过大-报错"}},[t._v("#")]),t._v(" 下载文件 文件过大 报错")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("download")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" xhr "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("XMLHttpRequest")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  xhr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"GET"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 以二进制文件修改")]),t._v("\n  xhr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("responseType "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"blob"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  xhr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onload")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" url "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" window"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("URL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createObjectURL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xhr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("response"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" a "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElement")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"a"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//新建a标签")]),t._v("\n    a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("download "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" name "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"file"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//下载下来的文件名")]),t._v("\n    a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("href "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" event "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MouseEvent")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"click"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("dispatchEvent")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  xhr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onreadystatechange")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 下载时readyState===3，一次请求一直被调用")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xhr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("readyState"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//  中途 xhr.abort() xhr.readyState===0 且 xhr.status===0")]),t._v("\n  xhr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("readyState 属性表示 Ajax 请求的当前状态。\n0 代表未初始化。 还没有调用 open 方法\n1 代表正在加载。 open 方法已被调用，但 send 方法还没有被调用\n2 代表已加载完毕。send 已被调用。请求已经开始\n3 代表交互中。服务器正在发送响应\n4 代表完成。响应发送完毕")]),t._v(" "),n("p",[t._v("场景：某些电脑(同一用户)，下载同样的文件，从页面点击下载报错，浏览器贴链接下载正常。\n报错：")]),t._v(" "),n("ol",[n("li",[t._v("Get net::ERR_CONTENT_LENGTH_MISMATCH 200 (OK)\nStatus Code: 200 OK\nnetwork status (failed)net::ERR_CONTENT_LENGTH_MISMATCH")]),t._v(" "),n("li",[t._v("(failed)net::ERR_FAILED 200 (OK) network 中的 sourceSize 为 0"),n("br"),t._v("\n请求异常中断导致没有下载")])]),t._v(" "),n("h3",{attrs:{id:"chrome-点击浏览器回退-页面不刷新"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#chrome-点击浏览器回退-页面不刷新"}},[t._v("#")]),t._v(" chrome 点击浏览器回退 页面不刷新")]),t._v(" "),n("p",[t._v("chrome 的 back/forward cache 机制")])])}),[],!1,null,null,null);s.default=e.exports}}]);