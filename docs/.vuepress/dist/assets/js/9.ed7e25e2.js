(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{448:function(t,s,a){t.exports=a.p+"assets/img/recoil.ee5d1e8b.jpg"},449:function(t,s,a){t.exports=a.p+"assets/img/tserror.df307612.jpg"},471:function(t,s,a){"use strict";a.r(s);var n=a(57),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h2",{attrs:{id:"_2022"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2022"}},[t._v("#")]),t._v(" 2022")]),t._v(" "),n("h3",{attrs:{id:"eslint-报错-忽略"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#eslint-报错-忽略"}},[t._v("#")]),t._v(" eslint 报错 忽略")]),t._v(" "),n("ol",[n("li",[t._v("/_ eslint-disable _/")]),t._v(" "),n("li",[t._v('在.eslintrc.js>rules 添加@typescript-eslint/no-var-requires ，如下：\nrules: {\n"@typescript-eslint/no-var-requires": 0,\n}')])]),t._v(" "),n("h3",{attrs:{id:"下载文件-文件过大-报错"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#下载文件-文件过大-报错"}},[t._v("#")]),t._v(" 下载文件 文件过大 报错")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("download")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" xhr "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("XMLHttpRequest")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  xhr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"GET"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 以二进制文件修改")]),t._v("\n  xhr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("responseType "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"blob"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  xhr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onload")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" url "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" window"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("URL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createObjectURL")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xhr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("response"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" a "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElement")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"a"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//新建a标签")]),t._v("\n    a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("download "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" name "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"file"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//下载下来的文件名")]),t._v("\n    a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("href "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" event "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MouseEvent")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"click"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    a"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("dispatchEvent")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  xhr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onreadystatechange")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 下载时readyState===3，一次请求一直被调用")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xhr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("readyState"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//  中途 xhr.abort() xhr.readyState===0 且 xhr.status===0")]),t._v("\n  xhr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("readyState 属性表示 Ajax 请求的当前状态。\n0 代表未初始化。 还没有调用 open 方法\n1 代表正在加载。 open 方法已被调用，但 send 方法还没有被调用\n2 代表已加载完毕。send 已被调用。请求已经开始\n3 代表交互中。服务器正在发送响应\n4 代表完成。响应发送完毕")]),t._v(" "),n("p",[t._v("场景：某些电脑(同一用户)，下载同样的文件，从页面点击下载报错，浏览器贴链接下载正常。\n报错：")]),t._v(" "),n("ol",[n("li",[t._v("Get net::ERR_CONTENT_LENGTH_MISMATCH 200 (OK)\nStatus Code: 200 OK\nnetwork status (failed)net::ERR_CONTENT_LENGTH_MISMATCH")]),t._v(" "),n("li",[t._v("(failed)net::ERR_FAILED 200 (OK) network 中的 sourceSize 为 0"),n("br"),t._v("\n请求异常中断导致没有下载")])]),t._v(" "),n("h3",{attrs:{id:"chrome-点击浏览器回退-页面不刷新"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#chrome-点击浏览器回退-页面不刷新"}},[t._v("#")]),t._v(" chrome 点击浏览器回退 页面不刷新")]),t._v(" "),n("p",[t._v("chrome 的 back/forward cache 机制")]),t._v(" "),n("h2",{attrs:{id:"_2023"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2023"}},[t._v("#")]),t._v(" 2023")]),t._v(" "),n("h3",{attrs:{id:"_02-02-taro-项目编译-h5-白屏"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_02-02-taro-项目编译-h5-白屏"}},[t._v("#")]),t._v(" 02/02 taro 项目编译 h5 白屏")]),t._v(" "),n("ol",[n("li",[t._v("部分安卓手机 UC 浏览器、苹果 safri 浏览器页面白屏；\n本地启动真机访问无异常"),n("br"),t._v("\n本地编译 h5 后使用真机访问白屏")])]),t._v(" "),n("p",[t._v("解决过程："),n("br"),t._v("\n使用 vconsole，CDN 方式引入，看到白屏页面报错："),n("br"),t._v("\n'Uncaught SyntaxError:'super' keyword unexpected here'"),n("br"),t._v("\n是项目中使用的 Recoil 兼容性问题，查看官网发现不支持 ES5，得另外使用 babel 编译。"),n("br"),t._v("\n将 Recoil 以 CDN 方式引入得以解决。暂未找到其他更好的办法。")]),t._v(" "),n("p",[n("img",{attrs:{src:a(448),alt:"Recoil"}})]),t._v(" "),n("ol",{attrs:{start:"2"}},[n("li",[n("p",[t._v("使用 Taro.redirectTo,reLaunch 跳转，路由变化但页面白屏\n版本升级")])]),t._v(" "),n("li",[n("p",[t._v("编译报错，sass 中不支持/运算"),n("br"),t._v("\n打补丁，单独处理")])])]),t._v(" "),n("h3",{attrs:{id:"_04-14-error-ts1110-build-type-expected"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_04-14-error-ts1110-build-type-expected"}},[t._v("#")]),t._v(" 04/14 Error TS1110 Build: Type expected")]),t._v(" "),n("p",[n("img",{attrs:{src:a(449),alt:"tserror"}})]),t._v(" "),n("p",[t._v("ts 版本过低,缺少部分类型定义,升级")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('"typescript": "^3.7.5"\n"typescript": "4.2.4",\n')])])]),n("h3",{attrs:{id:"_04-19-egg-混合-react-页面项目"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_04-19-egg-混合-react-页面项目"}},[t._v("#")]),t._v(" 04/19 egg 混合 react 页面项目")]),t._v(" "),n("p",[t._v("老项目采用 egg、jquery 开发、部分页面采用 react 重构、目前方案是将新页面放在一个 react 项目内打包放在老项目里，路由直接读取打包后的产物，问题：")]),t._v(" "),n("ol",[n("li",[n("p",[t._v("统一导航栏，新老页面都是用 react 中的导航栏"),n("br"),t._v("\n将导航栏单独打包输出，在老页面读取产物")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//webpack 配置")]),t._v("\nwebpackConfig"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("entry "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  header"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./src/header.tsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nplugins"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("htmlWebpackPlugin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"header.html"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    chunks"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"header"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    template"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./public/header.html"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])]),t._v(" "),n("li",[n("p",[t._v("需要区分环境读取对应的 build 包，全局变量_system_env 通过中间件统一传入")]),t._v(" "),n("div",{staticClass:"language-ejs extra-class"},[n("pre",{pre:!0,attrs:{class:"language-ejs"}},[n("code",[n("span",{pre:!0,attrs:{class:"token ejs language-ejs"}},[n("span",{pre:!0,attrs:{class:"token delimiter punctuation"}},[t._v("<%-")]),n("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("include")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'../../public/build-'")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("_system_env"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/header.html'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" ")]),n("span",{pre:!0,attrs:{class:"token delimiter punctuation"}},[t._v("-%>")])]),t._v("\n")])])])]),t._v(" "),n("li",[n("p",[t._v("antd 全局样式污染问题"),n("br"),t._v("\n没有发现好的解决办法、暂时通过覆盖解决")])])]),t._v(" "),n("h3",{attrs:{id:"_04-20-协助-app-解决问题"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_04-20-协助-app-解决问题"}},[t._v("#")]),t._v(" 04/20 协助 App 解决问题")]),t._v(" "),n("h4",{attrs:{id:"内嵌-h5-页面获取-app-的-token-首次未获取到"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#内嵌-h5-页面获取-app-的-token-首次未获取到"}},[t._v("#")]),t._v(" 内嵌 H5 页面获取 app 的 token，首次未获取到")]),t._v(" "),n("p",[t._v("安卓环境，清除缓存后重新登录 App，进入 h5 页面，未获取到 token，第二次进入 h5 页面正常。")]),t._v(" "),n("ul",[n("li",[t._v("h5 页面 PC、H5、App 共用，需要区分当前环境")]),t._v(" "),n("li",[t._v("token 有三种情况、H5 自身登录、PC 跳转 URL 带入、App 登录获取")]),t._v(" "),n("li",[t._v("区分是否首次从 App 进入，决定是否要获取 App token")])]),t._v(" "),n("h4",{attrs:{id:"app-内退出登录需要跳转到-app-登录页"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#app-内退出登录需要跳转到-app-登录页"}},[t._v("#")]),t._v(" app 内退出登录需要跳转到 App 登录页")]),t._v(" "),n("ul",[n("li",[t._v("区分环境")]),t._v(" "),n("li",[t._v("跳转 URL Schema")])])])}),[],!1,null,null,null);s.default=e.exports}}]);